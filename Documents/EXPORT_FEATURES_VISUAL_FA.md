# 📊 ویژگی‌های خروجی و تاریخ شمسی - راهنمای تصویری

## 🎯 نقشه ویژگی‌ها

```
┌─────────────────────────────────────────────────────────────┐
│                    برنامه مدیریت پارکینگ                     │
│                  با پشتیبانی کامل تاریخ شمسی                 │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
        ┌─────────────────────────────────────────┐
        │         سیستم تاریخ شمسی                │
        │     (تاریخ شمسی در تمام برنامه)         │
        └─────────────────────────────────────────┘
                              │
        ┌─────────────────────┴─────────────────────┐
        │                                           │
        ▼                                           ▼
┌───────────────┐                          ┌───────────────┐
│  صفحه اصلی    │                          │ صفحه گزارشات  │
│  HOME SCREEN  │                          │ REPORTS SCREEN│
└───────────────┘                          └───────────────┘
        │                                           │
        │                                           │
        ▼                                           ▼
┌───────────────┐                    ┌──────────────────────┐
│فعالیت اخیر    │                    │   رابط 4 تب          │
│  با تاریخ شمسی│                    │   ────────────────   │
└───────────────┘                    │ 1. داشبورد           │
                                     │ 2. ورودی‌ها          │
                                     │ 3. خروجی‌ها          │
                                     │ 4. آرشیو             │
                                     └──────────────────────┘
                                              │
                                              ▼
                                     ┌──────────────────────┐
                                     │   گزینه‌های خروجی    │
                                     │   ──────────────     │
                                     │   📊 Excel           │
                                     │   📄 CSV             │
                                     │   📕 PDF             │
                                     └──────────────────────┘
```

## 📅 جریان تاریخ شمسی

```
┌──────────────┐
│  DateTime    │  تاریخ/زمان سیستم
│  (میلادی)    │  2024-11-30 14:30
└──────┬───────┘
       │
       │ PersianDateUtils.toShamsiDate()
       ▼
┌──────────────┐
│   Jalali     │  تقویم فارسی
│   (شمسی)     │  1403/09/10
└──────┬───────┘
       │
       │ فرمت برای نمایش
       ▼
┌──────────────────────────────┐
│  فرمت‌های نمایش:             │
│  • 1403/09/10                │
│  • 14:30 - 1403/09/10        │
│  • 1403 آذر 10               │
│  • یکشنبه، 10 آذر 1403       │
└──────────────────────────────┘
```

## 📊 گردکار خروجی

```
┌─────────────────┐
│  عمل کاربر      │
│  (کلیک خروجی)   │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ دیالوگ فرمت     │
│  ─────────────  │
│  📊 Excel       │ ◄─── کاربر فرمت را انتخاب می‌کند
│  📄 CSV         │
│  📕 PDF         │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ سرویس خروجی     │
│  ─────────────  │
│  • دریافت داده  │
│  • تبدیل تاریخ  │
│  • تولید فایل   │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  ذخیره در دیسک  │
│  Documents/     │
│  entries_xxx    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  اعلان          │
│  "فایل ذخیره شد"│
└─────────────────┘
```

## 📈 طرح‌بندی صفحه گزارشات

```
╔═══════════════════════════════════════════════════════════╗
║                    گزارشات و آمار                         ║
║  ┌──────────┬──────────┬──────────┬──────────┐           ║
║  │ داشبورد  │ ورودی‌ها │ خروجی‌ها │  آرشیو   │           ║
║  └──────────┴──────────┴──────────┴──────────┘           ║
╠═══════════════════════════════════════════════════════════╣
║                                                           ║
║  ┌─────────────────┐  ┌─────────────────┐               ║
║  │  کل ورودی‌ها    │  │  کل خروجی‌ها    │               ║
║  │      150        │  │      145        │               ║
║  └─────────────────┘  └─────────────────┘               ║
║                                                           ║
║  ┌─────────────────┐  ┌─────────────────┐               ║
║  │ خودروهای داخل   │  │   درآمد کل      │               ║
║  │       5         │  │  725,000 تومان  │               ║
║  └─────────────────┘  └─────────────────┘               ║
║                                                           ║
║  ┌─────────────────────────────────────────┐             ║
║  │           آمار امروز                    │             ║
║  │  ─────────────────────────────────────  │             ║
║  │  ورودی‌های امروز: 150                   │             ║
║  │  خروجی‌های امروز: 145                   │             ║
║  │  درآمد امروز: 725,000 تومان             │             ║
║  │  میانگین مدت توقف: 120 دقیقه            │             ║
║  └─────────────────────────────────────────┘             ║
║                                                           ║
║  ┌──────────────────┐  ┌──────────────────┐             ║
║  │  📥 خروجی امروز  │  │   📁 آرشیو       │             ║
║  └──────────────────┘  └──────────────────┘             ║
║                                                           ║
╚═══════════════════════════════════════════════════════════╝
```

## 📋 طرح‌بندی کارت ورودی

```
┌─────────────────────────────────────────────────────┐
│  ┌───┐                                              │
│  │ ↓ │  ایران 12 الف 345 - 34                      │
│  └───┘                                              │
│        زمان ورود: 14:30 - 1403/09/10               │
│                                              #12345 │
└─────────────────────────────────────────────────────┘
```

## 📋 طرح‌بندی کارت خروجی

```
┌─────────────────────────────────────────────────────┐
│  ┌───┐                                              │
│  │ ↑ │  ایران 12 الف 345 - 34                      │
│  └───┘                                              │
│        زمان خروج: 16:45 - 1403/09/10               │
│                                              #12345 │
│  ┌─────────────────────────────────────────────┐   │
│  │  مدت توقف: 135 دقیقه  │  هزینه: 5,000 تومان│   │
│  └─────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────┘
```

## 📊 ساختار خروجی Excel

```
┌─────────────────────────────────────────────────────┐
│  Sheet: ورودی‌ها                                    │
├──────┬──────────┬─────────────┬────────┬──────────┤
│ ردیف │ شماره پلاک│ تاریخ شمسی  │ ساعت   │ شناسه    │
├──────┼──────────┼─────────────┼────────┼──────────┤
│  1   │ ایران 12 │ 1403/09/10  │ 14:30  │  12345   │
│  2   │ ایران 34 │ 1403/09/10  │ 14:35  │  12346   │
│  3   │ ایران 56 │ 1403/09/10  │ 14:40  │  12347   │
└──────┴──────────┴─────────────┴────────┴──────────┘

┌─────────────────────────────────────────────────────────────┐
│  Sheet: خروجی‌ها                                            │
├──────┬──────────┬─────────────┬────────┬──────┬──────┬─────┤
│ ردیف │ شماره پلاک│ تاریخ شمسی  │ ساعت   │ مدت  │ هزینه│شناسه│
├──────┼──────────┼─────────────┼────────┼──────┼──────┼─────┤
│  1   │ ایران 12 │ 1403/09/10  │ 16:45  │ 135  │ 5000 │12345│
│  2   │ ایران 34 │ 1403/09/10  │ 17:00  │ 145  │ 5000 │12346│
│  3   │ ایران 56 │ 1403/09/10  │ 17:15  │ 155  │ 5000 │12347│
├──────┴──────────┴─────────────┴────────┴──────┼──────┼─────┤
│                                    جمع کل:    │15000 │     │
└───────────────────────────────────────────────┴──────┴─────┘
```

## 📄 طرح‌بندی گزارش PDF

```
╔═══════════════════════════════════════════════════════╗
║                  گزارش کامل روزانه                    ║
╠═══════════════════════════════════════════════════════╣
║                                                       ║
║  تاریخ: یکشنبه، 10 آذر 1403                          ║
║                                                       ║
║  ┌─────────────────────────────────────────────┐     ║
║  │           خلاصه آماری                       │     ║
║  │  ─────────────────────────────────────────  │     ║
║  │  ظرفیت کل: 100                              │     ║
║  │  تعداد ورودی‌ها: 150                        │     ║
║  │  تعداد خروجی‌ها: 145                        │     ║
║  │  خودروهای داخل: 5                           │     ║
║  │  درآمد کل: 725,000 تومان                    │     ║
║  │  میانگین مدت توقف: 120 دقیقه                │     ║
║  └─────────────────────────────────────────────┘     ║
║                                                       ║
║  جزئیات ورودی‌ها                                     ║
║  ┌──────────────────────────────────────────┐        ║
║  │ شناسه │ ساعت │ تاریخ │ پلاک │ ردیف     │        ║
║  ├───────┼──────┼───────┼──────┼──────────┤        ║
║  │ 12345 │14:30 │1403/..│ایران│    1     │        ║
║  │ 12346 │14:35 │1403/..│ایران│    2     │        ║
║  └──────────────────────────────────────────┘        ║
║                                                       ║
╚═══════════════════════════════════════════════════════╝
```

## 🔄 نمونه‌های تبدیل تاریخ

```
┌─────────────────────────────────────────────────────┐
│  نمونه‌های تبدیل میلادی → شمسی                      │
├─────────────────────────────────────────────────────┤
│                                                     │
│  2024-11-30  →  1403/09/10                         │
│  2024-12-01  →  1403/09/11                         │
│  2024-12-21  →  1403/10/01  (شروع دی)              │
│  2025-03-21  →  1404/01/01  (سال نو!)              │
│                                                     │
└─────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────┐
│  نمونه‌های فرمت زمان                                │
├─────────────────────────────────────────────────────┤
│                                                     │
│  14:30:00  →  14:30                                │
│  09:05:30  →  09:05                                │
│  23:59:59  →  23:59                                │
│                                                     │
└─────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────┐
│  نمونه‌های فرمت مدت زمان                            │
├─────────────────────────────────────────────────────┤
│                                                     │
│  45 دقیقه    →  45 دقیقه                           │
│  120 دقیقه   →  2 ساعت                             │
│  150 دقیقه   →  2 ساعت و 30 دقیقه                  │
│  185 دقیقه   →  3 ساعت و 5 دقیقه                   │
│                                                     │
└─────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────┐
│  نمونه‌های فرمت ارز                                 │
├─────────────────────────────────────────────────────┤
│                                                     │
│  5000      →  5,000 تومان                          │
│  15000     →  15,000 تومان                         │
│  125000    →  125,000 تومان                        │
│  1250000   →  1,250,000 تومان                      │
│                                                     │
└─────────────────────────────────────────────────────┘
```

## 🎨 طرح رنگ

```
┌─────────────────────────────────────────────────────┐
│  رنگ‌های اجزا                                       │
├─────────────────────────────────────────────────────┤
│                                                     │
│  🟢 ورودی (Entry)      →  #2E7D32 (سبز)           │
│  🔴 خروجی (Exit)       →  #D32F2F (قرمز)          │
│  🔵 فعال (Active)      →  #1976D2 (آبی)           │
│  🟠 درآمد (Income)     →  #FF9800 (نارنجی)        │
│  ⚫ پس‌زمینه            →  #0F1C2E (آبی تیره)      │
│  ⚪ کارت‌ها             →  #1E3A5F (آبی متوسط)    │
│                                                     │
└─────────────────────────────────────────────────────┘
```

## 📱 سفر کاربر

```
1. راه‌اندازی برنامه
   ↓
2. مشاهده صفحه اصلی (با تاریخ‌های شمسی)
   ↓
3. رفتن به گزارشات
   ↓
4. انتخاب تب (داشبورد/ورودی‌ها/خروجی‌ها/آرشیو)
   ↓
5. کلیک دکمه خروجی
   ↓
6. انتخاب فرمت (Excel/CSV/PDF)
   ↓
7. تولید و ذخیره فایل
   ↓
8. اعلان موفقیت
   ↓
9. باز کردن/اشتراک‌گذاری فایل
```

## 🔧 پشته فناوری

```
┌─────────────────────────────────────────────────────┐
│  پشته فناوری                                        │
├─────────────────────────────────────────────────────┤
│                                                     │
│  فرانت‌اند:                                         │
│    • Flutter 3.0+                                   │
│    • Dart 3.0+                                      │
│    • Provider (مدیریت وضعیت)                        │
│                                                     │
│  تاریخ/زمان:                                        │
│    • shamsi_date (تقویم فارسی)                      │
│    • intl (فرمت‌بندی اعداد)                         │
│                                                     │
│  خروجی:                                             │
│    • excel (تولید Excel)                            │
│    • csv (خروجی CSV)                                │
│    • pdf (تولید PDF)                                │
│    • printing (پیش‌نمایش PDF)                       │
│                                                     │
│  سیستم فایل:                                        │
│    • path_provider (مسیرهای سیستم)                  │
│    • file_picker (عملیات فایل)                      │
│                                                     │
└─────────────────────────────────────────────────────┘
```

## 📊 جریان داده

```
┌──────────┐
│ پایگاه   │
│  داده    │
│ (SQLite) │
└────┬─────┘
     │
     │ درخواست API
     ▼
┌──────────┐
│  Django  │
│  بکند    │
└────┬─────┘
     │
     │ پاسخ JSON
     ▼
┌──────────┐
│ Provider │
│ (وضعیت)  │
└────┬─────┘
     │
     │ داده
     ▼
┌──────────┐      ┌──────────────┐
│   UI     │ ───► │ ابزارهای     │
│ ویجت‌ها  │      │ تاریخ (شمسی) │
└────┬─────┘      └──────────────┘
     │
     │ عمل خروجی
     ▼
┌──────────┐      ┌──────────────┐
│  سرویس   │ ───► │ سیستم فایل   │
│  خروجی   │      │ (ذخیره)      │
└──────────┘      └──────────────┘
```

---

## 🎯 مرجع سریع

### توابع پرکاربرد
```dart
// نمایش تاریخ
PersianDateUtils.toShamsiDate(DateTime.now())

// نمایش تاریخ با زمان
PersianDateUtils.toShamsiDateTime(DateTime.now())

// فرمت ارز
PersianDateUtils.formatCurrency(15000)

// فرمت مدت زمان
PersianDateUtils.formatDuration(150)

// خروجی به Excel
await exportService.exportEntriesToExcel(entries)

// تولید PDF
await exportService.generateFullReportPDF(...)
```

### مکان فایل‌ها
```
Windows: C:\Users\[User]\Documents\
Android: /storage/emulated/0/Documents/
```

### نام‌های فایل خروجی
```
entries_[timestamp].xlsx
exits_[timestamp].xlsx
entries_[timestamp].csv
exits_[timestamp].csv
```

---

**راهنمای تصویری کامل** ✅
**آماده برای**: توسعه، تست و آموزش کاربر
